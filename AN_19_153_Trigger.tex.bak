\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\author{Sven Dildick,Wei Shi (Rice University)}
\title{Determination of the Trigger Scale Factors for a search for new light bosons decaying to muon pairs with 2018 Data (AN-19-153 ).}


\begin{document}
\maketitle

\section{Introduction}
We use several multi-muon signal triggers (Tab.~\ref{tab:signaltriggers}) as described in Sec.~\ref{sec:evt_sel}. The typical tag-and-probe method cannot be used for the triple-muon triggers. The reference trigger method cannot be used either, since there is no shared single muon trigger leg. Instead, the overall efficiency is calculated at once on a control dataset with the orthogonal method.

\begin{table}[htb]
\centering
\caption{Signal Triggers used in the Analysis}
\begin{tabular}{|l|}
\hline
Trigger Path \\
\hline
\hline
HLT\_DoubleL2Mu23NoVtx\_2Cha \\
HLT\_Mu18\_Mu9\_SameSign \\
HLT\_TripleMu\_12\_10\_5 \\
HLT\_TrkMu12\_DoubleTrkMu5NoFiltersNoVtxv \\
\hline
\end{tabular}
\label{tab:signaltriggers}
\end{table}

\section{Methodology}
The scale factor of the signal triggers will be estimated with the orthogonal method using three-muon events emulating $WZ$ events as done in the previous iteration of this analysis ~\cite{CMS2016Result}. The orthogonal method assumes that such events are  triggered by the substantial SingleMu in the event topology and therefore independent of muons selection criteria. The efficiency of the triple-muon trigger is determined on events passing a set of selection criteria optimized to select $WZ$ events. This will be done both on data and on MC simulated events. The data are selected using a set of single muon triggers in the SingleMu dataset. SingleMu triggers with one or more muons in the selection are ignored. MC events are simulated for the processes WZ $\rightarrow 3l\nu$, ZZ $\rightarrow 4l$, and ttZ. The data and MC samples are cleaned by selecting high-quality muons to obtain a set of well-reconstructed $WZ$-like events. The selection criteria are being derived from Ref.~\cite{Khachatryan:2016tgp}. Data vs MC plots in the control region are made and the efficiency of the triple muon trigger is checked on the surviving events.

\section{Datasets}
We use the MiniAOD samples shown below in Tab.~\ref{tab:SingleMu_Run2018_datasets}. Events are pre-selected which have at least three muons with pT $> 10$ GeV and at least one muon with $p\_T > 20$ GeV and are required to be in the run range specified in this JSON file Cert\_314472-325175\_13TeV\_17SeptEarly\-ReReco2018ABC\_PromptEraD\_Collisions18\_JSON.txt. Events with more than 3 muons with $> 10$ GeV are rejected. The pre-selection accepts 2\% of the events in data as can be seen in Tab.~\ref{tab:SingleMu_Run2018_datasets}. Additionally we use WZ $\rightarrow 3l\nu$
, ZZ $\rightarrow 4l$, and ttZ Monte Carlo datasets shown in Tab.~\ref{tab:MC_datasets}.  The cross sections have been calculated with the GenXSecAnalyzer \footnote{https://twiki.cern.ch/twiki/bin/view/CMS/HowToGenXSecAnalyzer}. The mean number of interactions per bunch crossing for the 2018 pp run at 13 TeV and in simulation is shown in Fig.~\ref{fig:pileup_in_data}. Monte Carlo events are weighed with the integrated luminosity ( $59.7~ \mathrm{fb}^{-1}$), the generator weight, and the pileup weight (the ratio of the pileup distributions in Fig.~\ref{fig:pileup_in_data}).

\begin{table}[htb]
\footnotesize
\centering
\caption{SingleMuon data samples for the trigger scale factor studies.}
\begin{tabular}{|l|c|c|}
\hline
Dataset name & Total Events & Pre-selected Events\\
\hline
\hline
/SingleMuon/Run2018A-17Sep2018-v2/MINIAOD & 24,160,8232 & 5,945,878\\ 
/SingleMuon/Run2018B-17Sep2018-v1/MINIAOD & 11,991,8017  & 2,795,277 \\
/SingleMuon/Run2018C-17Sep2018-v1/MINIAOD & 11,003,2072 & 2,747,227 \\
/SingleMuon/Run2018D-PromptReco-v2/MINIAOD  & 506,717,754 & 7,906,762 \\
\hline
Total & 978,276,075 & 19,395,144 \\
\hline
\end{tabular}
\label{tab:SingleMu_Run2018_datasets}
\end{table}

\begin{table}[htb]
\footnotesize
\centering
\caption{Monte Carlo samples for the trigger scale factor studies.}
{
\begin{tabular}{| l | l | l | c | c | }
\hline
Abbreviation & Dataset name &  Events & Cross Section [pb]\\
\hline
\hline
WZTo3LNu & WZTo3LNu\_TuneCP5\_13TeV-amcatnloFXFX-pythia8 & 10,749,269 & $5.114 \pm 0.075$ \\
& /RunIIAutumn18MiniAOD-102X\_upgrade2018\_ & &  \\ 
& realistic\_v15-v1/MINIAODSIM & &  \\
%\hline
%WZTo3LNu2 &  /WZTo3LNu\_TuneCP5\_13TeV-amcatnloFXFX-pythia8  & 11248318 & $5.120 \pm 0.021$ \\
%& /RunIIAutumn18MiniAOD-102X\_upgrade2018\_ & & \\ 
%& realistic\_v15\_ext1-v2/MINIAODSIM  & & \\
%\hline
%WZTo3LNu3 &/WZTo3LNu\_TuneCP5\_13TeV-powheg-pythia8 & 1976600 & $4.658 \pm 0.005$ \\
%&/RunIIAutumn18MiniAOD-102X\_upgrade2018\_  & & \\
%& realistic\_v15\_ext1-v2/MINIAODSIM  & & \\
%\hline
%WZTo3LNu4 & /WZTo3LNu\_mllmin01\_NNPDF31\_TuneCP5\_13TeV &  89479400 & $62.17 \pm	0.23$\\
%& \_powheg\_pythia8/RunIIAutumn18MiniAOD-102X\_ & & \\
%& upgrade2018\_realistic\_v15-v1/MINIAODSIM & & \\
\hline
ZZTo4L & /ZZTo4L\_13TeV\_powheg\_pythia8\_TuneCP5\- & 19,089,600 & $1.325 \pm 0.002$ \\
& /RunIIAutumn18MiniAOD-102X\_upgrade2018\_ & & \\
& realistic\_v15-v1/MINIAODSIM & & \\
\hline
TTZToLLNuNu & /TTZToLLNuNu\_M-10\_TuneCP5\_13TeV-amcatnlo- & 13,280,000 & $0.2432 \pm 0.0003$ \\
& pythia8/RunIIAutumn18MiniAOD-102X\_upgrade2018\_ & & \\
& realistic\_v15\_ext1-v2/MINIAODSIM & &	 \\
\hline
\end{tabular}
}
\label{tab:MC_datasets}
\end{table}

\begin{figure}[htb]
\includegraphics[width=0.47\textwidth]{figures/pileup_pp_2018_69200.pdf}
\includegraphics[width=0.5\textwidth]{figures/pileup_2018MC_v2.pdf}
\caption{Left: Average pileup in 2018. Mean number of interactions per bunch crossing for the 2018 pp run at 13 TeV using the online luminosity values. The plot uses the CMS recommended value of 69.2 mb for the minimum bias cross section which is determined by finding the best agreement with data and is recommended for CMS analyses. Right: Simulated average pileup in 2018 with the \texttt{mix\_2018\_25ns\_JuneProjectionFull18\_PoissonOOTPU\_cfi} configuration.}
\label{fig:pileup_in_data}
\end{figure}

\newpage
\section{Event Selection}
Events are required to pass at least one SingleMuon trigger (see Tab.~\ref{tab:puremettriggers}). Furthermore, events must have exactly three muons $|\eta|<2.4$ and with transverse momenta thresholds $p_{\mathrm{T},1} > 20$ GeV, $p_{\mathrm{T},2} > 20$ GeV, $p_{\mathrm{T},3} > 10$ GeV. The events are further cleaned by requiring that each muon passes the medium muon ID. To suppress muons from hadrons decaying in-flight (nonprompt muons), selections on the muon impact parameter and distance to the interaction point (IP) are applied. The impact parameter must be $|d_{xy,i}| < 0.005$ cm and the distance to the IP $|d_{z,i}| < 0.01$ cm for each muon. Non-isolated muons are rejected. A relative isolation cut of  $relIso < 0.1$ is applied on each muon. Two muons with opposite charge and with an invariant mass compatible with the Z mass ($|m_{\mu\mu}-m_Z|<10$ GeV) are paired. At least one pair is required in each event. 
\\ \\
Table.~\ref{tab:event_selection_cutflow} shows the event selection in data and Monte Carlo. Figures~\ref{fig:data_vs_mc_1}-\ref{fig:data_vs_mc_7} showt the agreement between data and Monte  Carlo for several event variables.

\begin{table}[!]
\centering
\caption{SingleMu Triggers used in the Analysis}
\begin{tabular}{|l|}
\hline
Trigger Path \\
\hline
\hline
    HLT\_IsoMu20\_eta2p1\_LooseChargedIsoPFTauHPS27\_eta2p1\_CrossL1 \\
    HLT\_IsoMu20\_eta2p1\_LooseChargedIsoPFTauHPS27\_eta2p1\_TightID\_CrossL1 \\
    HLT\_IsoMu20\_eta2p1\_MediumChargedIsoPFTauHPS27\_eta2p1\_CrossL1 \\
    HLT\_IsoMu20\_eta2p1\_MediumChargedIsoPFTauHPS27\_eta2p1\_TightID\_CrossL1 \\
    HLT\_IsoMu20\_eta2p1\_TightChargedIsoPFTauHPS27\_eta2p1\_CrossL1 \\
    HLT\_IsoMu20\_eta2p1\_TightChargedIsoPFTauHPS27\_eta2p1\_TightID\_CrossL1 \\
    HLT\_IsoMu20 \\
    HLT\_IsoMu24\_TwoProngs35 \\
    HLT\_IsoMu24\_eta2p1 \\
    HLT\_IsoMu24 \\
    HLT\_IsoMu27 \\
    HLT\_IsoMu30 \\
    HLT\_L1SingleMu18 \\
    HLT\_L1SingleMu25 \\
    HLT\_L2Mu10 \\
    HLT\_L2Mu50 \\
    HLT\_Mu10\_TrkIsoVVL\_DiPFJet40\_DEta3p5\_MJJ750\_HTT350\_PFMETNoMu60 \\
    HLT\_Mu12 \\
    HLT\_Mu15\_IsoVVVL\_PFHT450\_CaloBTagDeepCSV\_4p5 \\
    HLT\_Mu15\_IsoVVVL\_PFHT450\_PFMET50 \\
    HLT\_Mu15\_IsoVVVL\_PFHT450 \\
    HLT\_Mu15\_IsoVVVL\_PFHT600 \\
    HLT\_Mu15 \\
    HLT\_Mu20 \\
    HLT\_Mu27 \\
    HLT\_Mu3\_PFJet40 \\
    HLT\_Mu3er1p5\_PFJet100er2p5\_PFMET100\_PFMHT100\_IDTight \\
    HLT\_Mu3er1p5\_PFJet100er2p5\_PFMET70\_PFMHT70\_IDTight \\
    HLT\_Mu3er1p5\_PFJet100er2p5\_PFMET80\_PFMHT80\_IDTight \\
    HLT\_Mu3er1p5\_PFJet100er2p5\_PFMET90\_PFMHT90\_IDTight \\
    HLT\_Mu3er1p5\_PFJet100er2p5\_PFMETNoMu100\_PFMHTNoMu100\_IDTight \\ 
    HLT\_Mu3er1p5\_PFJet100er2p5\_PFMETNoMu70\_PFMHTNoMu70\_IDTight \\
    HLT\_Mu3er1p5\_PFJet100er2p5\_PFMETNoMu80\_PFMHTNoMu80\_IDTight \\
    HLT\_Mu3er1p5\_PFJet100er2p5\_PFMETNoMu90\_PFMHTNoMu90\_IDTight \\
    HLT\_Mu4\_TrkIsoVVL\_DiPFJet90\_40\_DEta3p5\_MJJ750\_HTT300\_PFMETNoMu60 \\
    HLT\_Mu50\_IsoVVVL\_PFHT450 \\
    HLT\_Mu50 \\
    HLT\_Mu55 \\
    HLT\_Mu8\_TrkIsoVVL\_DiPFJet40\_DEta3p5\_MJJ750\_HTT300\_PFMETNoMu60 \\
    HLT\_OldMu100 \\
    HLT\_TkMu100 \\
  \hline
\end{tabular}
\label{tab:puremettriggers}
\end{table}


\begin{table}[htb]
\centering
\caption{Table with event selection for the three-muon control region.}
\begin{tabular}{|cccc|}
\hline
Selection & WZTo3LNu & ZZTo4Mu & Data \\
\hline
\hline
No selection
& 301245.23 & 70517.5327254 & 18051620 \\

Passes at least one orthogonal trigger
& 118895.46 & 22794.2715612 & 18014171 \\

Exactly three muons
& 22819.88 & 4019.38 & 3405670 \\

$|\eta_i| < 2.4$
& 22819.88 & 4019.38 & 3405670 \\

$p_{\mathrm{T},1} > 20$ GeV, $p_{\mathrm{T},2} > 20$ GeV, $p_{\mathrm{T},3} > 10$ GeV
& 1007.26 & 116.17 & 373507 \\

Medium muon ID
& 883.84 & 90.35 & 25518 \\

$|d_{xy,i}| < 0.005$ cm 
& 830.48 & 79.92 & 8069 \\

$|d_{z,i}| < 0.01$ cm
& 709.53 & 65.70 & 4652 \\

RelIso$relIso < 0.1$
& 466.64 & 39.49 & 591 \\

Two muons with opposite charge 
& 466.64 & 39.49 & 591 \\

$|m_{\mu\mu}-m_Z|<10$ GeV
& 389.29 & 23.46 & 402 \\

Passes at least one signal trigger
& 385.37 & 23.21 & 396 \\
\hline
\end{tabular}
\label{tab:event_selection_cutflow}
\end{table}


\begin{figure}[htb]
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu0_pT.pdf}
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu0_eta.pdf}
\\
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu0_phi.pdf}
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu0_charge.pdf}
\label{fig:data_vs_mc_1}
\caption{Data vs Monte Carlo comparisons in the control region.}
\end{figure}

\begin{figure}[htb]
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu0_dxy.pdf}
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu0_dz.pdf}
\\
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu0_PFIso.pdf}
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu0_isMedium.pdf}
\label{fig:data_vs_mc_2}
\caption{Data vs Monte Carlo comparisons in the control region (continued).}

\end{figure}


\begin{figure}[htb]
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu1_pT.pdf}
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu1_eta.pdf}
\\
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu1_phi.pdf}
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu1_charge.pdf}
\label{fig:data_vs_mc_3}
\caption{Data vs Monte Carlo comparisons in the control region (continued).}

\end{figure}

\begin{figure}[htb]
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu1_dxy.pdf}
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu1_dz.pdf}
\\
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu1_PFIso.pdf}
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu1_isMedium.pdf}
\label{fig:data_vs_mc_4}
\caption{Data vs Monte Carlo comparisons in the control region (continued).}

\end{figure}



\begin{figure}[htb]
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu2_pT.pdf}
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu2_eta.pdf}
\\
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu2_phi.pdf}
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu2_charge.pdf}
\label{fig:data_vs_mc_5}
\caption{Data vs Monte Carlo comparisons in the control region (continued).}

\end{figure}

\begin{figure}[htb]
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu2_dxy.pdf}
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu2_dz.pdf}
\\
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu2_PFIso.pdf}
\includegraphics[width=0.5\textwidth]{figures/Combine_selMu2_isMedium.pdf}
\label{fig:data_vs_mc_6}
\caption{Data vs Monte Carlo comparisons in the control region (continued).}

\end{figure}


\begin{figure}[htb]
\includegraphics[width=0.5\textwidth]{figures/Combine_mMuMu_OS.pdf}
\includegraphics[width=0.5\textwidth]{figures/Combine_mMuMu_SS.pdf}
\\
\includegraphics[width=0.5\textwidth]{figures/Combine_nBJet_20.pdf}
\includegraphics[width=0.5\textwidth]{figures/Combine_pfMET.pdf}
\\
\includegraphics[width=0.5\textwidth]{figures/Combine_pfMET_phi.pdf}
\label{fig:data_vs_mc_7}
\caption{Data vs Monte Carlo comparisons in the control region (continued).}

\end{figure}


\newpage
\section{Results} 
The trigger efficiency on Monte Carlo is evaluated as $\varepsilon_{WZTo3LNu} = 385.37 / 389.29 = 99\%$, $\varepsilon_{ZZTo4L} = 23.21/23.46= 99\%$. Efficiency in data is observed to be $\varepsilon_{Data} = 396 / 402 = 98.5\%$. This results in a trigger scale factor of $SF = 98.5\% /  99\% =99.5\%$. A statistical uncertainty of 5\% on the selected data events is quoted in the control region. The overall trigger scale factor is estimated to be $99.5\% \pm 5\%(\mathrm{stat.})$.
\end{document}
